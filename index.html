<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Noman Pro</title>

<style>
body{
    margin:0;
    font-family:Arial, sans-serif;
    background:#0f0f0f;
    color:#fff;
}
.container{
    max-width:500px;
    margin:auto;
    padding:20px;
}
.card{
    background:#1a1a1a;
    padding:15px;
    border-radius:12px;
    margin-top:15px;
}
button{
    padding:10px 20px;
    background:#00ffcc;
    border:none;
    border-radius:8px;
    cursor:pointer;
    font-weight:bold;
}
h2,h3{
    text-align:center;
    color:#00ffcc;
}
.rank{
    padding:8px;
    border-bottom:1px solid #333;
}
.top1{color:gold;}
.top2{color:silver;}
.top3{color:#cd7f32;}
</style>
</head>
<body>

<div class="container">

<h2>Noman Pro Dashboard</h2>

<div class="card">
<p><strong>User ID:</strong> <span id="userIdDisplay"></span></p>
<p><strong>Coin Balance:</strong> <span id="coinDisplay">0</span></p>
</div>

<div class="card">
<h3>Ad Task System</h3>

<p><strong>Ads Watched Today:</strong> 
<span id="taskCount">0</span> / 100</p>

<p><strong>Remaining Ads:</strong> 
<span id="remainingTasks">100</span></p>

<p><strong>Total Lifetime Ads:</strong> 
<span id="totalTasks">0</span></p>

<p><strong>Total Referrals:</strong> 
<span id="myRefs">0</span></p>

<p><strong>Total Referral Earnings:</strong> 
<span id="refEarnings">0</span> Coins</p>

<p id="taskStatus">‚úÖ Ads Available</p>

<button onclick="watchAd()">Watch Ad (+16 Coins)</button>
</div>

<div class="card">
<h3>Your Referral Link</h3>
<p id="refLink"></p>
<button onclick="copyLink()">Copy Link</button>
</div>

<div class="card">
<h3>üèÜ Top 20 Referrers</h3>
<div id="leaderboard"></div>
</div>

</div>

<script>

// ===== UNIQUE USER =====
let userId = localStorage.getItem("userId");
if(!userId){
  userId = "USER" + Math.floor(Math.random()*1000000);
  localStorage.setItem("userId", userId);
}
document.getElementById("userIdDisplay").innerText = userId;

// ===== USER KEYS =====
let coinKey = "coin_" + userId;
let taskKey = "adsToday_" + userId;
let totalKey = "adsTotal_" + userId;
let refKey = "refCount_" + userId;
let refEarnKey = "refEarn_" + userId;
let cooldownKey = "cooldown_" + userId;

// ===== LOAD DATA =====
let coins = parseInt(localStorage.getItem(coinKey)) || 0;
let taskCount = parseInt(localStorage.getItem(taskKey)) || 0;
let totalTasks = parseInt(localStorage.getItem(totalKey)) || 0;
let myRefs = parseInt(localStorage.getItem(refKey)) || 0;
let refEarnings = parseInt(localStorage.getItem(refEarnKey)) || 0;
let cooldownStart = localStorage.getItem(cooldownKey);

// ===== DISPLAY UPDATE =====
function updateDisplay(){
    document.getElementById("coinDisplay").innerText = coins;
    document.getElementById("taskCount").innerText = taskCount;
    document.getElementById("remainingTasks").innerText = 100 - taskCount;
    document.getElementById("totalTasks").innerText = totalTasks;
    document.getElementById("myRefs").innerText = myRefs;
    document.getElementById("refEarnings").innerText = refEarnings;
}
updateDisplay();

// ===== REFERRAL SYSTEM =====
function getRef(){
    const params = new URLSearchParams(window.location.search);
    return params.get("ref");
}

let refCode = getRef();
let referralGiven = localStorage.getItem("referralGiven_" + userId);

if(refCode && !referralGiven && refCode !== userId){

    let refCoinKey = "coin_" + refCode;
    let refCountKeyOther = "refCount_" + refCode;
    let refEarnKeyOther = "refEarn_" + refCode;

    let refCoins = parseInt(localStorage.getItem(refCoinKey)) || 0;
    let refCountOther = parseInt(localStorage.getItem(refCountKeyOther)) || 0;
    let refEarnOther = parseInt(localStorage.getItem(refEarnKeyOther)) || 0;

    refCoins += 3000;
    refCountOther += 1;
    refEarnOther += 3000;

    localStorage.setItem(refCoinKey, refCoins);
    localStorage.setItem(refCountKeyOther, refCountOther);
    localStorage.setItem(refEarnKeyOther, refEarnOther);

    localStorage.setItem("referralGiven_" + userId, "yes");

    alert("Referral Successful! 3000 Coins Rewarded.");
}

// Referral Link
let referralLink = window.location.href.split("?")[0] + "?ref=" + userId;
document.getElementById("refLink").innerText = referralLink;

function copyLink(){
    navigator.clipboard.writeText(referralLink);
    alert("Referral Link Copied!");
}

// ===== AD SYSTEM =====
const LIMIT = 100;
const COOLDOWN = 60*60*1000;

function checkCooldown(){
    if(cooldownStart){
        let now = new Date().getTime();
        let passed = now - parseInt(cooldownStart);

        if(passed >= COOLDOWN){
            localStorage.removeItem(cooldownKey);
            taskCount = 0;
            localStorage.setItem(taskKey,0);
            document.getElementById("taskStatus").innerText = "‚úÖ Ads Available";
        }else{
            let left = COOLDOWN - passed;
            let min = Math.floor(left/60000);
            let sec = Math.floor((left%60000)/1000);
            document.getElementById("taskStatus").innerText =
            "‚è≥ Cooldown: "+min+"m "+sec+"s";
            setTimeout(checkCooldown,1000);
        }
    }
}
checkCooldown();

function watchAd(){

    if(localStorage.getItem(cooldownKey)){
        alert("Ad limit reached! Wait 1 hour.");
        return;
    }

    taskCount++;
    totalTasks++;
    coins += 16;

    localStorage.setItem(taskKey,taskCount);
    localStorage.setItem(totalKey,totalTasks);
    localStorage.setItem(coinKey,coins);

    if(taskCount>=LIMIT){
        localStorage.setItem(cooldownKey,new Date().getTime());
        cooldownStart = new Date().getTime();
        alert("100 Ads Completed! 1 Hour Cooldown Started.");
        checkCooldown();
    }

    updateDisplay();
}

// ===== LEADERBOARD =====
function generateLeaderboard(){
    let list=[];
    for(let i=0;i<localStorage.length;i++){
        let key=localStorage.key(i);
        if(key.startsWith("refCount_")){
            let id=key.replace("refCount_","");
            let count=parseInt(localStorage.getItem(key));
            list.push({id,count});
        }
    }
    list.sort((a,b)=>b.count-a.count);
    list=list.slice(0,20);

    let html="";
    list.forEach((u,i)=>{
        let cls="";
        if(i==0)cls="top1";
        if(i==1)cls="top2";
        if(i==2)cls="top3";

        html+=`<div class="rank ${cls}">
        <strong>#${i+1}</strong> - ${u.id}
        <span style="float:right">${u.count} Referrals</span>
        </div>`;
    });
    document.getElementById("leaderboard").innerHTML=html;
}
generateLeaderboard();

</script>

</body>
  </html>
